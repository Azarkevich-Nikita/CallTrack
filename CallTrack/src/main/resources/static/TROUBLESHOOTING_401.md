# Диагностика ошибки 401 при входе

## Возможные причины ошибки 401

### 1. Неверные учетные данные
- **Проблема**: Неправильный логин, email, номер телефона или пароль
- **Решение**: Проверьте правильность введенных данных
- **Проверка**: Убедитесь, что пользователь существует в базе данных

### 2. Неправильный формат данных
- **Проблема**: Сервер ожидает другой формат полей (например, `username` вместо `login`)
- **Решение**: Проверьте документацию API или код сервера, какой формат данных ожидается
- **Текущий формат отправки**:
  ```json
  {
    "login": "значение",
    "password": "пароль",
    "rememberMe": false
  }
  ```

### 3. Проблемы на сервере
- **Проблема**: Ошибка в обработке запроса на сервере
- **Решение**: Проверьте логи сервера
- **Проверка**: Убедитесь, что endpoint `/api/v1/auth/login` существует и работает

### 4. Проблемы с аутентификацией
- **Проблема**: Проблемы с JWT токенами, сессиями или другими механизмами аутентификации
- **Решение**: Проверьте настройки безопасности на сервере

### 5. CORS или другие заголовки
- **Проблема**: Блокировка запроса из-за CORS или других политик безопасности
- **Решение**: Проверьте настройки CORS на сервере

## Как диагностировать проблему

### Шаг 1: Откройте консоль разработчика
1. Нажмите `F12` или `Ctrl+Shift+I` (Windows/Linux) / `Cmd+Option+I` (Mac)
2. Перейдите на вкладку "Console"

### Шаг 2: Попробуйте войти
1. Введите данные для входа
2. Нажмите "Войти"
3. Проверьте логи в консоли

### Шаг 3: Проверьте логи
Вы должны увидеть:
- `Отправка запроса на вход:` - данные, которые отправляются
- `Ответ сервера:` - статус ответа
- `Тело ответа (raw):` - тело ответа от сервера
- `Распарсенный JSON:` - распарсенные данные (если JSON)

### Шаг 4: Проверьте вкладку Network
1. Перейдите на вкладку "Network"
2. Найдите запрос к `/api/v1/auth/login`
3. Проверьте:
   - **Request Headers** - заголовки запроса
   - **Request Payload** - данные запроса
   - **Response Headers** - заголовки ответа
   - **Response** - тело ответа

### Шаг 5: Проверьте сервер
1. Убедитесь, что сервер запущен
2. Проверьте логи сервера
3. Убедитесь, что endpoint `/api/v1/auth/login` существует
4. Проверьте, какой формат данных ожидает сервер

## Что проверить на сервере

### 1. Endpoint существует
```java
@PostMapping("/api/v1/auth/login")
public ResponseEntity<?> login(@RequestBody LoginRequest request) {
    // ...
}
```

### 2. Формат данных
Проверьте, какие поля ожидает сервер:
- `login` или `username` или `email`?
- `password`
- `rememberMe` (может быть опциональным)

### 3. Обработка ошибок
Сервер должен возвращать понятные сообщения об ошибках:
```json
{
  "message": "Неверный логин или пароль",
  "error": "UNAUTHORIZED"
}
```

### 4. Статус коды
- `200` - успешный вход
- `401` - неавторизован (неверные данные)
- `400` - некорректные данные
- `500` - ошибка сервера

## Частые проблемы и решения

### Проблема: Сервер возвращает 401, но пользователь существует
**Решение**: Проверьте хеширование пароля на сервере. Пароль должен проверяться с использованием того же алгоритма, что и при регистрации.

### Проблема: Сервер ожидает другие поля
**Решение**: Измените формат данных в `scripts/login.js`, метод `submitLogin()`:
```javascript
const formData = {
    username: login,  // вместо login
    password: password,
    rememberMe: rememberMe
};
```

### Проблема: Сервер не возвращает JSON
**Решение**: Код уже обрабатывает это. Проверьте логи в консоли, чтобы увидеть, что возвращает сервер.

## Контакты для помощи
Если проблема не решена, предоставьте:
1. Логи из консоли браузера
2. Логи с сервера
3. Формат данных, которые ожидает сервер
4. Код endpoint'а на сервере (если возможно)
